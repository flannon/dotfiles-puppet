---
# tasks file for fedora_sb
#- name: virtualbox repo file
#  template: 
#    src: templates/virtualbox.repo.j2
#    dest: /etc/yum.repos.d/virtualbox.repo
#    owner: root
#    group: root
#    mode: 0644

#- name: vscode repo file
#  template: 
#    src: templates/vscode.repo.j2
#    dest: /etc/yum.repos.d/vscode.repo
#    owner: root
#    group: root
#    mode: 0644

#- name: dnf update
#  dnf:
#    name: "*"
#    state: latest

#- name: group install Develoment tools
#  dnf:
#    name: 
#      - '@Development Tools'
#    state: latest

- name: Install flathub flatpak repo
  flatpak_remote:
    name: flathub
    state: present
    flatpakrepo_url: https://dl.flathub.org/repo/flathub.flatpakrepo

- name: Install flatpaks
  flatpak:
    name: "{{ item }}"
    state: "{{ flatpak_state }}"
  with_items:
    - com.calibre_ebook.calibre
    - com.calibre_ebook.calibre
    - com.github.bilelmoussaoui.Authenticator
    - com.github.mdh34.hackup
    - com.github.unrud.djpdf
    - com.jgraph.drawio.desktop
    - com.slack.Slack
    - com.uploadedlobster.peek
    - com.vinszent.GnomeTwitch
    - com.visualstudio.code
    - com.visualstudio.code.oss
    - com.xnview.XnConvert
    - com.xnview.XnRetro
    - com.xnview.XnSketch
    - com.xnview.XnViewMP
    - ind.ie.Gnomit
    - io.atom.Atom
    - io.github.GnomeMpv
    - net.bartkessels.getit
    - org.freedesktop.Platform.ffmpeg/x86_64/1.6
    - org.gimp.Gimp
    - org.gnome.Books
    - org.gnome.Calculator
    - org.gnome.Calendar
    - org.gnome.Chess
    - org.gnome.Contacts
    - org.gnome.clocks
    - org.gnome.eog
    - org.gnome.ghex
    - org.gnome.gitg
    - org.gnome.Music
    - org.gnome.Notes
    - org.gnome.Podcasts
    - org.gnome.Polari
    - org.gnome.PasswordSafe
    - org.gnome.Shotwell
    - org.gnome.SoundRecorder
    - org.gnome.Totem
    - org.gnome.Weather
    - org.inkscape.Inkscape
    - org.photoqt.Photoqt
    - org.signal.Signal
    - org.videolan.VLC
    - org.vim.Vim
    - org.wireshark.Wireshark
    - org.libreoffice.LibreOffice
    - org.zotero.Zotero
    - us.zoom.Zoom
    

#- name: packages
#  dnf:
#    name:
#      #- awscli
#      #- binutils
#      - clang
#      - cmake
#      #- code
#      - compat-ffmpeg28
#      - dkms
#      - dnf-utils
#      - device-mapper-persistent-data
#      - facter
#      - git
#      - glibc-devel
#      - glibc-headers
#      - golang
#      - jq
#      - kernel-headers
#      - kernel-devel 
#      - libgomp
#      - libselinux-python
#      - libxkbcommon
#      - lvm2
#      - make
#      - net-tools
#      - openconnect
#      - patch
#      - python2-devel
#      - python3-devel
#      - qt5-qtx11extras
#      - redhat-rpm-config
#      - snapd
#      - VirtualBox-5.2
#      - vagrant
#    state: latest

#- name: pip install packages
#  pip:
#    name:
#      - boto
#      - boto3
#      - molecule
#      - six
#      - awscli
#    extra_args: --user
        
- name: "bashrc for {{ user }}"
  template:
    src: templates/bashrc.j2
    dest: ~{{ user }}/.bashrc
    owner: "{{ user }}"
    group: "{{ user }}"
    mode: 0644

# Not working - the regexp still isn't right
#- name: Add user to sudoers
#  lineinfile:
#    path: /etc/sudoers
#    state: present
#    #regexp: "#%wheel\s\ALL=(ALL)\sNOPASSWD:\sALL"
#    regexp: "#%wheel  ALL="
#    line: "%wheel ALL=(ALL) NOPASSWD: ALL"
#    validate: '/usr/sbin/visudo -cf %s'
